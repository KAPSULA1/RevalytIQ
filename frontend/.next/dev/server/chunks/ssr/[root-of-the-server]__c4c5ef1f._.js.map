{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 14, "column": 0}, "map": {"version":3,"sources":["file:///home/kapo/Projects/RevalytIQ/frontend/app/dashboard/page.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/app/dashboard/page.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/app/dashboard/page.tsx <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;uCACe,IAAA,yaAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAA0R,GACvT,wDACA","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///home/kapo/Projects/RevalytIQ/frontend/app/dashboard/page.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/app/dashboard/page.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/app/dashboard/page.tsx\",\n    \"default\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;uCACe,IAAA,yaAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAAsQ,GACnS,oCACA","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 42, "column": 0}, "map": {"version":3,"sources":["file:///home/kapo/Projects/RevalytIQ/frontend/app/dashboard/page.tsx"],"sourcesContent":["\"use client\";\nimport { useEffect, useMemo } from \"react\";\nimport { useRouter } from \"next/navigation\";\nimport { useQuery, useQueryClient } from \"@tanstack/react-query\";\nimport toast from \"react-hot-toast\";\nimport Navbar from \"../../components/Navbar\";\nimport Sidebar from \"../../components/Sidebar\";\nimport KPIStat from \"./components/KPIStat\";\nimport RevenueChart from \"./components/RevenueChart\";\nimport OrdersTable from \"./components/OrdersTable\";\nimport { fetchKPIs, fetchOrders, Order } from \"../../lib/auth\";\nimport { hydrateAuthFromStorage, useAuth } from \"../../lib/store\";\n\nexport default function Dashboard() {\n  const router = useRouter();\n  const queryClient = useQueryClient();\n  const access = useAuth((s) => s.access);\n\n  // ðŸ” Authentication check\n  useEffect(() => {\n    hydrateAuthFromStorage();\n    const token = useAuth.getState().access;\n    if (!token) router.replace(\"/\");\n  }, [router]);\n\n  // ðŸ“Š Fetch KPIs and Orders\n  const kpiQ = useQuery({\n    queryKey: [\"kpis\"],\n    queryFn: fetchKPIs,\n    enabled: !!access,\n  });\n  const ordersQ = useQuery({\n    queryKey: [\"orders\"],\n    queryFn: fetchOrders,\n    enabled: !!access,\n  });\n\n  // ðŸ’° Aggregate revenue over time\n  const revenueSeries = useMemo(() => {\n    const items = (Array.isArray(ordersQ.data)\n      ? ordersQ.data\n      : ordersQ.data?.results) as Order[] | undefined;\n    const buckets = new Map<string, number>();\n    (items ?? []).forEach((o) => {\n      const d = new Date(o.created_at);\n      const key = `${d.getFullYear()}-${String(d.getMonth() + 1).padStart(2, \"0\")}-${String(\n        d.getDate()\n      ).padStart(2, \"0\")}`;\n      buckets.set(key, (buckets.get(key) ?? 0) + o.amount);\n    });\n    return Array.from(buckets.entries()).map(([x, y]) => {\n      const numericY = Number.parseFloat(String(y));\n      return {\n        x,\n        y: Number.isFinite(numericY) ? Number(numericY.toFixed(2)) : 0,\n      };\n    });\n  }, [ordersQ.data]);\n\n  // ðŸ”„ Refresh handler\n  const onRefresh = async () => {\n    await Promise.all([\n      queryClient.invalidateQueries({ queryKey: [\"kpis\"] }),\n      queryClient.invalidateQueries({ queryKey: [\"orders\"] }),\n    ]);\n    toast.success(\"Data refreshed\");\n  };\n\n  // ðŸŒ€ Loading / Error states\n  const anyLoading = kpiQ.isLoading || ordersQ.isLoading;\n  const anyError = kpiQ.isError || ordersQ.isError;\n\n  if (anyLoading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen text-gray-500\">\n        Loading analytics data...\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen grid grid-rows-[auto_1fr] bg-gray-50\">\n      <Navbar />\n      <div className=\"grid grid-cols-[240px_1fr]\">\n        <Sidebar />\n        <main className=\"p-6 space-y-6\">\n          <div className=\"flex items-center justify-between\">\n            <h1 className=\"text-xl font-semibold\">Analytics Overview</h1>\n            <button\n              onClick={onRefresh}\n              className=\"text-sm px-3 py-1.5 rounded-lg bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-60\"\n              disabled={anyLoading}\n            >\n              {anyLoading ? \"Refreshing...\" : \"Refresh\"}\n            </button>\n          </div>\n\n          {anyError && (\n            <p className=\"text-red-600\">Failed to load data. Please refresh.</p>\n          )}\n\n          <div className=\"grid md:grid-cols-3 gap-4\">\n            <KPIStat\n              label=\"Revenue\"\n              value={kpiQ.data ? `$${kpiQ.data.revenue.toFixed(2)}` : \"...\"}\n            />\n            <KPIStat label=\"Orders\" value={kpiQ.data?.orders ?? \"...\"} />\n            <KPIStat label=\"AOV\" value={kpiQ.data ? `$${kpiQ.data.aov}` : \"...\"} />\n          </div>\n\n          <RevenueChart points={revenueSeries} />\n\n          <div>\n            <h2 className=\"text-lg font-semibold mb-3\">Recent Orders</h2>\n            <OrdersTable\n              orders={\n                (Array.isArray(ordersQ.data)\n                  ? ordersQ.data\n                  : ordersQ.data?.results) ?? []\n              }\n            />\n          </div>\n        </main>\n      </div>\n    </div>\n  );\n}\n"],"names":["useEffect","useMemo","useRouter","useQuery","useQueryClient","toast","Navbar","Sidebar","KPIStat","RevenueChart","OrdersTable","fetchKPIs","fetchOrders","hydrateAuthFromStorage","useAuth","jsx","_jsx","jsxs","_jsxs","Dashboard","router","queryClient","access","s","token","getState","replace","kpiQ","queryKey","queryFn","enabled","ordersQ","revenueSeries","items","Array","isArray","data","results","buckets","Map","forEach","o","d","Date","created_at","key","getFullYear","String","getMonth","padStart","getDate","set","get","amount","from","entries","map","x","y","numericY","Number","parseFloat","isFinite","toFixed","onRefresh","Promise","all","invalidateQueries","success","anyLoading","isLoading","anyError","isError","className","children","onClick","disabled","label","value","revenue","orders","aov","points"],"mappings":"","ignoreList":[],"debugId":null}}]
}